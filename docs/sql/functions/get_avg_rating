CREATE OR REPLACE FUNCTION get_avg_rating(movie_id INT)
RETURNS NUMERIC AS $$
BEGIN
  RETURN (
    SELECT AVG(rating)
    FROM rating
    WHERE movie_id = get_avg_rating.movie_id
  );
END;
$$ LANGUAGE plpgsql;