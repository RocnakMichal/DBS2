<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Group Detail</title>
</head>
<body>

<h2 th:text="${group.name}">Group Name</h2>

<p>
    Owner: <strong th:text="${group.owner.name}">Owner</strong><br/>
    Private: <strong th:text="${group.private ? 'Yes' : 'No'}">Yes/No</strong><br/>
    Members: <strong th:text="${group.groupMembers.size()}">0</strong><br/>
    Created: <strong th:text="${#temporals.format(group.createdAt, 'yyyy-MM-dd HH:mm')}">Date</strong>
</p>

<hr/>

<!-- IF NOT A MEMBER -->
<div th:if="${!isMember}">
    <p th:if="${group.private}">This group is private. You need a password to join.</p>

    <form th:action="@{/groups/{id}/join(id=${group.id})}" method="post">
        <div th:if="${group.private}">
            <input type="password" name="password" placeholder="Enter group password" required />
        </div>
        <button type="submit">Join Group</button>
    </form>

    <p th:if="${error}" th:text="${error}" style="color: red;"></p>
</div>

<!-- IF MEMBER -->
<div th:if="${isMember}">
    <ul>
        <li th:each="member : ${group.groupMembers}">
            <span th:text="${member.user.name}">User Name</span>
            <span th:if="${member.user.id == group.owner.id}"></span>
        </li>
    </ul>

    <form th:action="@{/groups/{id}/leave(id=${group.id})}" method="post">
        <button type="submit">Leave Group</button>
    </form>

    <h3>Group Movies</h3>
    <ul>
        <li th:each="gm : ${group.groupMovies}" th:text="${gm.movie.title}">Movie</li>
    </ul>

    <h4>Add Movie</h4>
    <form th:action="@{/groups/{id}/add-movie(id=${group.id})}" method="post">
        <select name="movieId">
            <option th:each="m : ${allMovies}" th:value="${m.id}" th:text="${m.title}"></option>
        </select>
        <button type="submit">Add Movie</button>
    </form>
</div>

<a href="/groups">Go back</a>

</body>
</html>